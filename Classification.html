<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="" />
    <meta name="author" content="Kenneth Chen" />
    <meta name="generator" content="Pelican (VoidyBootstrap theme)" />

    <title>Second Post - QUANTGO's BLOG</title>

   
        <link rel="stylesheet"
              href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"
              integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u"
              crossorigin="anonymous" />
      <link rel="stylesheet"
            href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"
            integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN"
            crossorigin="anonymous">



    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js" integrity="sha384-FFgGfda92tXC8nCNOxrCQ3R8x1TNkMFqDZVQdDaaJiiVbjkPBXIJBx0o7ETjy8Bh" crossorigin="anonymous"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js" integrity="sha384-ZoaMbDF+4LeFxg6WdScQ9nnR1QC2MIRxA1O9KWEXQwns1G8UNyIEZIQidzb0T1fo" crossorigin="anonymous"></script>
    <![endif]-->

    <link rel="shortcut icon" href="http://kennethchentt.github.io/favicon.ico" />
        <link href="http://kennethchentt.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="QUANTGO's BLOG Atom Feed" />
  </head>

  <body>
   
    <nav class="navbar navbar-default">
      <div class="container">
	   <div class="navbar-header">
		<button type="button" class="navbar-toggle" 
				data-toggle="collapse" data-target="#main-navbar-collapse">
		  <span class="sr-only">Toggle navigation</span>
		  <span class="icon-bar"></span>
		  <span class="icon-bar"></span>
		  <span class="icon-bar"></span>
		</button>
		<a class="navbar-brand" href="http://kennethchentt.github.io/" rel="home">
          <i class="fa fa-home fa-fw fa-lg"> </i> </a>
       </div>

      <div class="collapse navbar-collapse" id="main-navbar-collapse">
        <ul class="nav navbar-nav">
            <li class="divider"></li>
            <li class="">
              <a href="http://kennethchentt.github.io/archives.html">Archives</a>
            </li>
          <li class="divider"></li>
            <li><a href="http://kennethchentt.github.io/feeds/all.atom.xml" 
                   type="application/atom+xml" rel="alternate">
                <i class="fa fa-rss fa-fw fa-lg"></i> </a></li>
        </ul> <!-- /nav -->
      </div> <!-- /navbar-collapse -->
	  </div> <!-- /container -->
    </nav> <!-- /navbar -->

	<div class="jumbotron" id="overview">
	  <div class="container">
		<h1><a href="http://kennethchentt.github.io/">QUANTGO's BLOG</a></h1>
	  </div>
	</div>

    <div class="container" id="main-container">
        <div class="" id="content">
<article itemscope="itemscope" itemtype="http://schema.org/BlogPosting">
  <header class="article-header">
<abbr class="article-header-date">
  Fri 01 December 2017
</abbr> <h1>
  <a href="http://kennethchentt.github.io/Classification.html" rel="bookmark"
     title="Permalink to Second Post">
    Second Post
  </a>
</h1><div class="article-header-info">
  <p>
      Posted by <a href="http://kennethchentt.github.io/author/kenneth.html">Kenneth</a>
    in 
    <a href="http://kennethchentt.github.io/category/posts.html">
      posts</a>
    &nbsp;&nbsp;
  </p>
</div> <!-- /.article-header-info -->  </header>
  <div class="content-body" itemprop="text articleBody">
	<style type="text/css">/*!
*
* IPython notebook
*
*/
/* CSS font colors for translated ANSI colors. */
.ansibold {
  font-weight: bold;
}
/* use dark versions for foreground, to improve visibility */
.ansiblack {
  color: black;
}
.ansired {
  color: darkred;
}
.ansigreen {
  color: darkgreen;
}
.ansiyellow {
  color: #c4a000;
}
.ansiblue {
  color: darkblue;
}
.ansipurple {
  color: darkviolet;
}
.ansicyan {
  color: steelblue;
}
.ansigray {
  color: gray;
}
/* and light for background, for the same reason */
.ansibgblack {
  background-color: black;
}
.ansibgred {
  background-color: red;
}
.ansibggreen {
  background-color: green;
}
.ansibgyellow {
  background-color: yellow;
}
.ansibgblue {
  background-color: blue;
}
.ansibgpurple {
  background-color: magenta;
}
.ansibgcyan {
  background-color: cyan;
}
.ansibggray {
  background-color: gray;
}
div.cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  border-radius: 2px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  border-width: 1px;
  border-style: solid;
  border-color: transparent;
  width: 100%;
  padding: 5px;
  /* This acts as a spacer between cells, that is outside the border */
  margin: 0px;
  outline: none;
  border-left-width: 1px;
  padding-left: 5px;
  background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%);
}
div.cell.jupyter-soft-selected {
  border-left-color: #90CAF9;
  border-left-color: #E3F2FD;
  border-left-width: 1px;
  padding-left: 5px;
  border-right-color: #E3F2FD;
  border-right-width: 1px;
  background: #E3F2FD;
}
@media print {
  div.cell.jupyter-soft-selected {
    border-color: transparent;
  }
}
div.cell.selected {
  border-color: #ababab;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 5px, transparent 5px, transparent 100%);
}
@media print {
  div.cell.selected {
    border-color: transparent;
  }
}
div.cell.selected.jupyter-soft-selected {
  border-left-width: 0;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 7px, #E3F2FD 7px, #E3F2FD 100%);
}
.edit_mode div.cell.selected {
  border-color: #66BB6A;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #66BB6A -40px, #66BB6A 5px, transparent 5px, transparent 100%);
}
@media print {
  .edit_mode div.cell.selected {
    border-color: transparent;
  }
}
.prompt {
  /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */
  min-width: 14ex;
  /* This padding is tuned to match the padding on the CodeMirror editor. */
  padding: 0.4em;
  margin: 0px;
  font-family: monospace;
  text-align: right;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
  /* Don't highlight prompt number selection */
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  /* Use default cursor */
  cursor: default;
}
@media (max-width: 540px) {
  .prompt {
    text-align: left;
  }
}
div.inner_cell {
  min-width: 0;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_area {
  border: 1px solid #cfcfcf;
  border-radius: 2px;
  background: #f7f7f7;
  line-height: 1.21429em;
}
/* This is needed so that empty prompt areas can collapse to zero height when there
   is no content in the output_subarea and the prompt. The main purpose of this is
   to make sure that empty JavaScript output_subareas have no height. */
div.prompt:empty {
  padding-top: 0;
  padding-bottom: 0;
}
div.unrecognized_cell {
  padding: 5px 5px 5px 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.unrecognized_cell .inner_cell {
  border-radius: 2px;
  padding: 5px;
  font-weight: bold;
  color: red;
  border: 1px solid #cfcfcf;
  background: #eaeaea;
}
div.unrecognized_cell .inner_cell a {
  color: inherit;
  text-decoration: none;
}
div.unrecognized_cell .inner_cell a:hover {
  color: inherit;
  text-decoration: none;
}
@media (max-width: 540px) {
  div.unrecognized_cell > div.prompt {
    display: none;
  }
}
div.code_cell {
  /* avoid page breaking on code cells when printing */
}
@media print {
  div.code_cell {
    page-break-inside: avoid;
  }
}
/* any special styling for code cells that are currently running goes here */
div.input {
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.input {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_prompt {
  color: #303F9F;
  border-top: 1px solid transparent;
}
div.input_area > div.highlight {
  margin: 0.4em;
  border: none;
  padding: 0px;
  background-color: transparent;
}
div.input_area > div.highlight > pre {
  margin: 0px;
  border: none;
  padding: 0px;
  background-color: transparent;
}
/* The following gets added to the <head> if it is detected that the user has a
 * monospace font with inconsistent normal/bold/italic height.  See
 * notebookmain.js.  Such fonts will have keywords vertically offset with
 * respect to the rest of the text.  The user should select a better font.
 * See: https://github.com/ipython/ipython/issues/1503
 *
 * .CodeMirror span {
 *      vertical-align: bottom;
 * }
 */
.CodeMirror {
  line-height: 1.21429em;
  /* Changed from 1em to our global default */
  font-size: 14px;
  height: auto;
  /* Changed to auto to autogrow */
  background: none;
  /* Changed from white to allow our bg to show through */
}
.CodeMirror-scroll {
  /*  The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/
  /*  We have found that if it is visible, vertical scrollbars appear with font size changes.*/
  overflow-y: hidden;
  overflow-x: auto;
}
.CodeMirror-lines {
  /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */
  /* we have set a different line-height and want this to scale with that. */
  padding: 0.4em;
}
.CodeMirror-linenumber {
  padding: 0 8px 0 4px;
}
.CodeMirror-gutters {
  border-bottom-left-radius: 2px;
  border-top-left-radius: 2px;
}
.CodeMirror pre {
  /* In CM3 this went to 4px from 0 in CM2. We need the 0 value because of how we size */
  /* .CodeMirror-lines */
  padding: 0;
  border: 0;
  border-radius: 0;
}
/*

Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org>
Adapted from GitHub theme

*/
.highlight-base {
  color: #000;
}
.highlight-variable {
  color: #000;
}
.highlight-variable-2 {
  color: #1a1a1a;
}
.highlight-variable-3 {
  color: #333333;
}
.highlight-string {
  color: #BA2121;
}
.highlight-comment {
  color: #408080;
  font-style: italic;
}
.highlight-number {
  color: #080;
}
.highlight-atom {
  color: #88F;
}
.highlight-keyword {
  color: #008000;
  font-weight: bold;
}
.highlight-builtin {
  color: #008000;
}
.highlight-error {
  color: #f00;
}
.highlight-operator {
  color: #AA22FF;
  font-weight: bold;
}
.highlight-meta {
  color: #AA22FF;
}
/* previously not defined, copying from default codemirror */
.highlight-def {
  color: #00f;
}
.highlight-string-2 {
  color: #f50;
}
.highlight-qualifier {
  color: #555;
}
.highlight-bracket {
  color: #997;
}
.highlight-tag {
  color: #170;
}
.highlight-attribute {
  color: #00c;
}
.highlight-header {
  color: blue;
}
.highlight-quote {
  color: #090;
}
.highlight-link {
  color: #00c;
}
/* apply the same style to codemirror */
.cm-s-ipython span.cm-keyword {
  color: #008000;
  font-weight: bold;
}
.cm-s-ipython span.cm-atom {
  color: #88F;
}
.cm-s-ipython span.cm-number {
  color: #080;
}
.cm-s-ipython span.cm-def {
  color: #00f;
}
.cm-s-ipython span.cm-variable {
  color: #000;
}
.cm-s-ipython span.cm-operator {
  color: #AA22FF;
  font-weight: bold;
}
.cm-s-ipython span.cm-variable-2 {
  color: #1a1a1a;
}
.cm-s-ipython span.cm-variable-3 {
  color: #333333;
}
.cm-s-ipython span.cm-comment {
  color: #408080;
  font-style: italic;
}
.cm-s-ipython span.cm-string {
  color: #BA2121;
}
.cm-s-ipython span.cm-string-2 {
  color: #f50;
}
.cm-s-ipython span.cm-meta {
  color: #AA22FF;
}
.cm-s-ipython span.cm-qualifier {
  color: #555;
}
.cm-s-ipython span.cm-builtin {
  color: #008000;
}
.cm-s-ipython span.cm-bracket {
  color: #997;
}
.cm-s-ipython span.cm-tag {
  color: #170;
}
.cm-s-ipython span.cm-attribute {
  color: #00c;
}
.cm-s-ipython span.cm-header {
  color: blue;
}
.cm-s-ipython span.cm-quote {
  color: #090;
}
.cm-s-ipython span.cm-link {
  color: #00c;
}
.cm-s-ipython span.cm-error {
  color: #f00;
}
.cm-s-ipython span.cm-tab {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=);
  background-position: right;
  background-repeat: no-repeat;
}
div.output_wrapper {
  /* this position must be relative to enable descendents to be absolute within it */
  position: relative;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  z-index: 1;
}
/* class for the output area when it should be height-limited */
div.output_scroll {
  /* ideally, this would be max-height, but FF barfs all over that */
  height: 24em;
  /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */
  width: 100%;
  overflow: auto;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  display: block;
}
/* output div while it is collapsed */
div.output_collapsed {
  margin: 0px;
  padding: 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
div.out_prompt_overlay {
  height: 100%;
  padding: 0px 0.4em;
  position: absolute;
  border-radius: 2px;
}
div.out_prompt_overlay:hover {
  /* use inner shadow to get border that is computed the same on WebKit/FF */
  -webkit-box-shadow: inset 0 0 1px #000;
  box-shadow: inset 0 0 1px #000;
  background: rgba(240, 240, 240, 0.5);
}
div.output_prompt {
  color: #D84315;
}
/* This class is the outer container of all output sections. */
div.output_area {
  padding: 0px;
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.output_area .MathJax_Display {
  text-align: left !important;
}
div.output_area 
div.output_area 
div.output_area img,
div.output_area svg {
  max-width: 100%;
  height: auto;
}
div.output_area img.unconfined,
div.output_area svg.unconfined {
  max-width: none;
}
/* This is needed to protect the pre formating from global settings such
   as that of bootstrap */
.output {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.output_area {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
div.output_area pre {
  margin: 0;
  padding: 0;
  border: 0;
  vertical-align: baseline;
  color: black;
  background-color: transparent;
  border-radius: 0;
}
/* This class is for the output subarea inside the output_area and after
   the prompt div. */
div.output_subarea {
  overflow-x: auto;
  padding: 0.4em;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
  max-width: calc(100% - 14ex);
}
div.output_scroll div.output_subarea {
  overflow-x: visible;
}
/* The rest of the output_* classes are for special styling of the different
   output types */
/* all text output has this class: */
div.output_text {
  text-align: left;
  color: #000;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
}
/* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */
div.output_stderr {
  background: #fdd;
  /* very light red background for stderr */
}
div.output_latex {
  text-align: left;
}
/* Empty output_javascript divs should have no height */
div.output_javascript:empty {
  padding: 0;
}
.js-error {
  color: darkred;
}
/* raw_input styles */
div.raw_input_container {
  line-height: 1.21429em;
  padding-top: 5px;
}
pre.raw_input_prompt {
  /* nothing needed here. */
}
input.raw_input {
  font-family: monospace;
  font-size: inherit;
  color: inherit;
  width: auto;
  /* make sure input baseline aligns with prompt */
  vertical-align: baseline;
  /* padding + margin = 0.5em between prompt and cursor */
  padding: 0em 0.25em;
  margin: 0em 0.25em;
}
input.raw_input:focus {
  box-shadow: none;
}
p.p-space {
  margin-bottom: 10px;
}
div.output_unrecognized {
  padding: 5px;
  font-weight: bold;
  color: red;
}
div.output_unrecognized a {
  color: inherit;
  text-decoration: none;
}
div.output_unrecognized a:hover {
  color: inherit;
  text-decoration: none;
}
.rendered_html {
  color: #000;
  /* any extras will just be numbers: */
}



.rendered_html :link {
  text-decoration: underline;
}
.rendered_html :visited {
  text-decoration: underline;
}






.rendered_html h1:first-child {
  margin-top: 0.538em;
}
.rendered_html h2:first-child {
  margin-top: 0.636em;
}
.rendered_html h3:first-child {
  margin-top: 0.777em;
}
.rendered_html h4:first-child {
  margin-top: 1em;
}
.rendered_html h5:first-child {
  margin-top: 1em;
}
.rendered_html h6:first-child {
  margin-top: 1em;
}








.rendered_html * + ul {
  margin-top: 1em;
}
.rendered_html * + ol {
  margin-top: 1em;
}


.rendered_html pre,



.rendered_html tr,
.rendered_html th,

.rendered_html td,


.rendered_html * + table {
  margin-top: 1em;
}

.rendered_html * + p {
  margin-top: 1em;
}

.rendered_html * + img {
  margin-top: 1em;
}
.rendered_html img,

.rendered_html img.unconfined,

div.text_cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.text_cell > div.prompt {
    display: none;
  }
}
div.text_cell_render {
  /*font-family: "Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;*/
  outline: none;
  resize: none;
  width: inherit;
  border-style: none;
  padding: 0.5em 0.5em 0.5em 0.4em;
  color: #000;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
a.anchor-link:link {
  text-decoration: none;
  padding: 0px 20px;
  visibility: hidden;
}
h1:hover .anchor-link,
h2:hover .anchor-link,
h3:hover .anchor-link,
h4:hover .anchor-link,
h5:hover .anchor-link,
h6:hover .anchor-link {
  visibility: visible;
}
.text_cell.rendered .input_area {
  display: none;
}
.text_cell.rendered 
.text_cell.unrendered .text_cell_render {
  display: none;
}
.cm-header-1,
.cm-header-2,
.cm-header-3,
.cm-header-4,
.cm-header-5,
.cm-header-6 {
  font-weight: bold;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}
.cm-header-1 {
  font-size: 185.7%;
}
.cm-header-2 {
  font-size: 157.1%;
}
.cm-header-3 {
  font-size: 128.6%;
}
.cm-header-4 {
  font-size: 110%;
}
.cm-header-5 {
  font-size: 100%;
  font-style: italic;
}
.cm-header-6 {
  font-size: 100%;
  font-style: italic;
}
</style>
<style type="text/css">.highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #A0A000 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #BA2121 } /* Literal.String.Affix */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0000FF } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style>
<style type="text/css">
/* Temporary definitions which will become obsolete with Notebook release 5.0 */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-bold { font-weight: bold; }
</style>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Logistic-Regression">Logistic Regression<a class="anchor-link" href="#Logistic-Regression">¶</a></h3><p>Unlike linear regression, multi-linear regression, logistic regression is used for classification tasks. In binary classfication, the classifier must assign instances to one of the two classes. In multilabel classfication, the classifier must assign a subset of the labels to each instance</p>
<p>This notebook will work thru several classfication problems using logistic regression, discuss performnace measures for the classification task, and apply some of the feature extraction techniques that learned in last chapter.</p>
<p><strong>some problems with response variable is not normally distributed</strong>.
Linear regression assumes that a constant change in the value of an explanatory variable results in a constant change in the value of response variable, an assumption that does not hold if the value of the response variable represents a probability.</p>
<p>Generalized linear models remove this assumption by relating a linear combination of the explantory variables to the response variable using a <em>link function</em>.</p>
<p>The <strong>response variable</strong> is modeled as a <em>function of a linear combination</em> of the explanatory variables using the <strong>logistic function</strong> (which always returns a value between zero and one):
$$F(t)=\frac{1}{1+e^{-t}}$$, where <em>t</em> is equal to a linear combination of explanatory variables.</p>
<p>example: <strong>Spam filtering</strong></p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [2]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'data/SMSSpamCollection'</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">'</span><span class="se">\t</span><span class="s1">'</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'Number of spam messages:'</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="s1">'spam'</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'Number of ham messages:'</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="s1">'ham'</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>      0                                                  1
0   ham  Go until jurong point, crazy.. Available only ...
1   ham                      Ok lar... Joking wif u oni...
2  spam  Free entry in 2 a wkly comp to win FA Cup fina...
3   ham  U dun say so early hor... U c already then say...
4   ham  Nah I don't think he goes to usf, he lives aro...
Number of spam messages: 747
Number of ham messages: 4825
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's make some predictions using scikit-learn's LogisticRegression class:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [39]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="k">import</span> <span class="n">TfidfVectorizer</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model.logistic</span> <span class="k">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.cross_validation</span> <span class="k">import</span> <span class="n">train_test_split</span><span class="p">,</span> <span class="n">cross_val_score</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'data/SMSSpamCollection'</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">'</span><span class="se">\t</span><span class="s1">'</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">X_train_raw</span><span class="p">,</span> <span class="n">X_test_raw</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="c1">#feature extraction and preprocessing part</span>
<span class="n">vectorizer</span> <span class="o">=</span> <span class="n">TfidfVectorizer</span><span class="p">()</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train_raw</span><span class="p">)</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test_raw</span><span class="p">)</span>

<span class="n">classifier</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">()</span>
<span class="n">classifier</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">classifier</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">prediction</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">predictions</span><span class="p">[:</span><span class="mi">10</span><span class="p">]):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'Prediction: </span><span class="si">%s</span><span class="s1">, Message: </span><span class="si">%s</span><span class="s1">'</span><span class="o">%</span><span class="p">(</span><span class="n">prediction</span><span class="p">,</span> <span class="n">X_test_raw</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Prediction: ham, Message: We're all getting worried over here, derek and taylor have already assumed the worst
Prediction: ham, Message: I have gone into get info bt dont know what to do
Prediction: ham, Message: Not getting anywhere with this damn job hunting over here!
Prediction: ham, Message: Sorry, got a late start, we're on the way
Prediction: ham, Message: Will do. Was exhausted on train this morning. Too much wine and pie. You sleep well too
Prediction: ham, Message: That one week leave i put know that time. Why.
Prediction: ham, Message: Let's pool our money together and buy a bunch of lotto tickets. If we win I get &lt;#&gt; % u get &lt;#&gt; %. Deal?
Prediction: ham, Message: Two fundamentals of cool life: "Walk, like you are the KING"...! OR "Walk like you Dont care,whoever is the KING"!... Gud nyt
Prediction: ham, Message: I thk 530 lor. But dunno can get tickets a not. Wat u doing now?
Prediction: spam, Message: FreeMsg Why haven't you replied to my text? I'm Randy, sexy, female and live local. Luv to hear from u. Netcollex Ltd 08700621170150p per msg reply Stop to end
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>How well does our classifier perform?</strong></p>
<p>The performance metrics for linear regression (e.g. R-square) are inappropriate for this task. below is our next discussion</p>
<h3 id="Binary-classfication-performance-metrices">Binary classfication performance metrices<a class="anchor-link" href="#Binary-classfication-performance-metrices">¶</a></h3><p>The most common metrices are <strong>accuracy, precision, recall, F1 measure, and ROC AUC score</strong>.</p>
<p><strong>confusion matrix</strong> - can be used to visualize true and flase positives and negatives.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [11]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">pylab</span> inline
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Populating the interactive namespace from numpy and matplotlib
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [18]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="k">import</span> <span class="n">confusion_matrix</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">y_test</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">confusion_matrix</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'True label'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Predicted label'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>[[4 1]
 [2 3]]
</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Accuracy</strong> measures a fraction of classifier's predictions that are correct.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [19]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="k">import</span> <span class="n">accuracy_score</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'Accuracy:'</span><span class="p">,</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Accuracy: 0.7
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Precision</strong>, <strong>Recall</strong> and <strong>F1 Measure</strong></p>
<p><em>Precision</em>, is the fraction of how many positive predictions that are correct, which is given by the following ratio:
$$ P = \frac{TP}{TP+FP}$$</p>
<p><em>Recall</em>, is the fraction of how many true positive being identified, which is given by
$$ R = \frac{TP}{TP+FN}$$</p>
<p><em>Fall out</em>, is the fraction of how many false positive being idenfitied, which given by
$$ F = \frac{FP}{FP+TN}$$</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [46]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="k">import</span> <span class="n">TfidfVectorizer</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model.logistic</span> <span class="k">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.cross_validation</span> <span class="k">import</span> <span class="n">train_test_split</span><span class="p">,</span> <span class="n">cross_val_score</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'data/SMSSpamCollection'</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">'</span><span class="se">\t</span><span class="s1">'</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">'label'</span><span class="p">,</span><span class="s1">'message'</span><span class="p">]</span>
<span class="c1">#Is it 'ham' or 'spam', we need a way to tell skearn</span>
<span class="n">encoded_labels</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">'label'</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="mi">1</span> <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="s1">'spam'</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>

<span class="n">X_train_raw</span><span class="p">,</span> <span class="n">X_test_raw</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">'message'</span><span class="p">],</span> <span class="n">encoded_labels</span><span class="p">)</span>
<span class="n">vectorizer</span> <span class="o">=</span> <span class="n">TfidfVectorizer</span><span class="p">()</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train_raw</span><span class="p">)</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_test_raw</span><span class="p">)</span>
<span class="n">classifier</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">()</span>
<span class="n">classifier</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>
<span class="n">precisions</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">classifier</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">'precision'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'Precision'</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">precisions</span><span class="p">),</span> <span class="n">precisions</span><span class="p">)</span>
<span class="n">recalls</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">classifier</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">'recall'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'Recall'</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">recalls</span><span class="p">),</span> <span class="n">recalls</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Precision 0.989607341016 [ 1.          0.98591549  0.97402597  0.98809524  1.        ]
Recall 0.662073324905 [ 0.61946903  0.61946903  0.66964286  0.74107143  0.66071429]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Result analysis</strong>: our classifier's precision is 0.989; almost all of the messages that it predicted as spam were actually spam.
It's recall is lower, indicating that it incorrectly classfified approximately 34 percent of spams messages as ham.</p>
<p><strong>F1 measure</strong>: A model with perfect precision or recall scores might not reflect the true predictbility of the model, both can lead to a bias given the skew distribution of the sample. Thus, F1 measure is used to penalizes classifiers with imbalanced precision and recall scores. A model with perfect precision and recall scores will achieve an F1 score of one. A model with a perfect precision score and recall score of zero wil achieve and F1 score of zero. F1 score is calculated using the following formula:
$$F1=2\frac{P*R}{P+R}$$</p>
<p>Above example F1 score:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [48]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">f1s</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">classifier</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">'f1'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'F1'</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">f1s</span><span class="p">),</span> <span class="n">f1s</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>F1 0.792437076303 [ 0.76502732  0.76086957  0.79365079  0.84693878  0.79569892]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The arithmetic mean of the classifier's precision and recall scores is 0.792. As the difference betwwen the classifier's precision and recall is small, the F1 measure's penalty is small. Models are sometimes evaluated using the F0.5 and F2 scores, which favor precision over recall and recall over precision, respectively.</p>
<h3 id="ROC-AUC">ROC AUC<a class="anchor-link" href="#ROC-AUC">¶</a></h3><p>A <strong>Receiver Operating Characteristic</strong> or <strong>ROC Curve</strong>, visualizes a classifer's performance. It plots classifier's <strong>recall</strong> against its <strong>fall out</strong>.</p>
<p><strong>AUC</strong> is the area under the ROC curve, it reduces the ROC curve to a single value, which represents the expected performance of the classifier.</p>
<p>Let's plot the ROC curve for our SMS spam classifier:</p>
<p>(<em>You do not do a</em> fit<em>transform on the test data because, when you fit a Random Forest, the Random Forest learns the classification rules based on the values of the features that you provide it. If these rules are to be applied to classify the test set then you need to make sure that the test features are calculated in the same way using the same vocabulary. If the vocabulary of the training and the test features is different, then features will not really make sense as they will reflect a vocabulary that is separate from the one the document was trained on.</em>)</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [79]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="k">import</span> <span class="n">TfidfVectorizer</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model.logistic</span> <span class="k">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.cross_validation</span> <span class="k">import</span> <span class="n">train_test_split</span><span class="p">,</span> <span class="n">cross_val_score</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="k">import</span> <span class="n">roc_curve</span><span class="p">,</span> <span class="n">auc</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'data/SMSSpamCollection'</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">'</span><span class="se">\t</span><span class="s1">'</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">'label'</span><span class="p">,</span><span class="s1">'message'</span><span class="p">]</span>
<span class="c1">#Is it 'ham' or 'spam', we need a way to tell skearn</span>
<span class="n">encoded_labels</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">'label'</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="mi">1</span> <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="s1">'spam'</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
<span class="n">X_train_raw</span><span class="p">,</span> <span class="n">X_test_raw</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">'message'</span><span class="p">],</span> <span class="n">encoded_labels</span><span class="p">)</span>
<span class="n">vectorizer</span> <span class="o">=</span> <span class="n">TfidfVectorizer</span><span class="p">()</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train_raw</span><span class="p">)</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test_raw</span><span class="p">)</span>
<span class="n">classifier</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">()</span>
<span class="n">classifier</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">classifier</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">false_positive_rate</span><span class="p">,</span> <span class="n">recall</span><span class="p">,</span> <span class="n">thresholds</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predictions</span><span class="p">)</span>
<span class="n">roc_auc</span> <span class="o">=</span> <span class="n">auc</span><span class="p">(</span><span class="n">false_positive_rate</span><span class="p">,</span> <span class="n">recall</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Receiver Operating Characteristic'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">false_positive_rate</span><span class="p">,</span> <span class="n">recall</span><span class="p">,</span> <span class="s1">'b'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'AUC = </span><span class="si">%0.2f</span><span class="s1">'</span> <span class="o">%</span> <span class="n">roc_auc</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'lower right'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">'r--'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Recall'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Fall-out'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
gg==
" />
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Tuning-models-with-grid-search">Tuning models with grid search<a class="anchor-link" href="#Tuning-models-with-grid-search">¶</a></h3><p>Hyperparameters of the logistic regression SMS classifier include the value of the regularization term and thresholds used to remove words that appear too frequenly or infrequently. In scikit-learn, hyperparameters are set thru the model's constructor. In previous example, we didn't set any arguments for <em>logisticRegression()</em>; we used the default values for all of the hyperparameters. <strong>Grid Search</strong> is a common method to select the hyperparameter values that produce the best model.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [81]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="k">import</span> <span class="n">TfidfVectorizer</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model.logistic</span> <span class="k">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.grid_search</span> <span class="k">import</span> <span class="n">GridSearchCV</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="k">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.cross_validation</span> <span class="k">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="k">import</span> <span class="n">precision_score</span><span class="p">,</span> <span class="n">recall_score</span><span class="p">,</span> <span class="n">accuracy_score</span>

<span class="n">pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
        <span class="p">(</span><span class="s1">'vect'</span><span class="p">,</span> <span class="n">TfidfVectorizer</span><span class="p">(</span><span class="n">stop_words</span><span class="o">=</span><span class="s1">'english'</span><span class="p">)),</span>
        <span class="p">(</span><span class="s1">'clf'</span><span class="p">,</span> <span class="n">LogisticRegression</span><span class="p">())</span>
    <span class="p">])</span>

<span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'vect__max_df'</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.25</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.75</span><span class="p">),</span>
    <span class="s1">'vect__stop_words'</span><span class="p">:(</span><span class="s1">'english'</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
    <span class="s1">'vect__max_features'</span><span class="p">:</span> <span class="p">(</span><span class="mi">2500</span><span class="p">,</span><span class="mi">5000</span><span class="p">,</span><span class="mi">10000</span><span class="p">,</span><span class="kc">None</span><span class="p">),</span>
    <span class="s1">'vect__ngram_range'</span><span class="p">:</span> <span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span>
    <span class="s1">'vect__use_idf'</span><span class="p">:</span> <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
    <span class="s1">'vect__norm'</span><span class="p">:</span> <span class="p">(</span><span class="s1">'l1'</span><span class="p">,</span> <span class="s1">'l2'</span><span class="p">),</span>
    <span class="s1">'clf__penalty'</span><span class="p">:(</span><span class="s1">'l1'</span><span class="p">,</span> <span class="s1">'l2'</span><span class="p">),</span>
    <span class="s1">'clf__C'</span><span class="p">:(</span><span class="mf">0.01</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span>
<span class="p">}</span>

<span class="c1">## GridSearchCV() takes an estimator, a parameter space, and performance measure. The argument n_jopbs specifiies</span>
<span class="c1">## the maximum number of concurrent jobs; set n_jobs to -1 to use all CPU cores. Note that fit() must be called in a python</span>
<span class="c1">## main block in order to fork additional processes; example must be executed as a scrpit, and not in an interactive interpreter</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">"__main__"</span><span class="p">:</span>
    <span class="n">grid_search</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">pipeline</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">'accuracy'</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'data/SMSSpamCollection'</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">'</span><span class="se">\t</span><span class="s1">'</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">'label'</span><span class="p">,</span><span class="s1">'message'</span><span class="p">]</span>
    <span class="c1">#Is it 'ham' or 'spam', we need a way to tell skearn</span>
    <span class="n">encoded_labels</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">'label'</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="mi">1</span> <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="s1">'spam'</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
    <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">'message'</span><span class="p">],</span> <span class="n">encoded_labels</span><span class="p">)</span>
    <span class="n">grid_search</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'Best score: </span><span class="si">%0.3f</span><span class="s1">'</span> <span class="o">%</span> <span class="n">grid_search</span><span class="o">.</span><span class="n">best_score_</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'Best parameters set:'</span><span class="p">)</span>
    <span class="n">best_parameters</span> <span class="o">=</span> <span class="n">grid_search</span><span class="o">.</span><span class="n">best_estimator_</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">param_name</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">parameters</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'</span><span class="se">\t</span><span class="si">%s</span><span class="s1">: </span><span class="si">%r</span><span class="s1">'</span> <span class="o">%</span> <span class="p">(</span><span class="n">param_name</span><span class="p">,</span> <span class="n">best_parameters</span><span class="p">[</span><span class="n">param_name</span><span class="p">]))</span>
    <span class="n">predictions</span> <span class="o">=</span> <span class="n">grid_search</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'Accuracy:'</span><span class="p">,</span>  <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predictions</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'Precision:'</span><span class="p">,</span> <span class="n">precision_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predictions</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'Recall:'</span><span class="p">,</span> <span class="n">recall_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predictions</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>[Parallel(n_jobs=-1)]: Done  34 tasks      | elapsed:    6.6s
[Parallel(n_jobs=-1)]: Done 184 tasks      | elapsed:   10.9s
[Parallel(n_jobs=-1)]: Done 434 tasks      | elapsed:   18.4s
[Parallel(n_jobs=-1)]: Done 784 tasks      | elapsed:   39.2s
[Parallel(n_jobs=-1)]: Done 1234 tasks      | elapsed:  1.4min
[Parallel(n_jobs=-1)]: Done 1784 tasks      | elapsed:  1.7min
[Parallel(n_jobs=-1)]: Done 2434 tasks      | elapsed:  2.5min
[Parallel(n_jobs=-1)]: Done 3184 tasks      | elapsed:  3.1min
[Parallel(n_jobs=-1)]: Done 4034 tasks      | elapsed:  4.8min
[Parallel(n_jobs=-1)]: Done 4608 out of 4608 | elapsed:  6.1min finished
</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Fitting 3 folds for each of 1536 candidates, totalling 4608 fits
Best score: 0.984
Best parameters set:
	clf__C: 10
	clf__penalty: 'l2'
	vect__max_df: 0.5
	vect__max_features: 2500
	vect__ngram_range: (1, 2)
	vect__norm: 'l2'
	vect__stop_words: None
	vect__use_idf: True
Accuracy: 0.987796123475
Precision: 0.982857142857
Recall: 0.924731182796
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Summary: Optimizing the values of the hyperparameters has improved our model's recall value on test set. (<em>Recall 0.662073324905 previous compared to now 0.924</em>)</p>
<p><strong>Brief introduction of piepline</strong></p>
<p>官网的介绍如下：
pipeline of transforms with a final estimator.
最后估计量的变换管线
Sequentially apply a list of transforms and a final estimator. Intermediate steps of the pipeline must be ‘transforms’, that is, they must implement fit and transform methods. The final estimator only needs to implement fit.
The purpose of the pipeline is to assemble several steps that can be cross-validated together while setting different parameters. For this, it enables setting parameters of the various steps using their names and the parameter name separated by a ‘__’, as in the example below.</p>
<p>解释：pipeline的目的就是当设置不同的参数时组合几个可以一起交叉验证的步骤。所以可以使用组合这几个步骤的名字和它们的属性参数（不过需要在参数前面加_来连接）。</p>
<p>参数：Parameters: 
steps: list :
List of (name, transform) tuples (implementing fit/transform) that are chained, in the order in which they are chained, with the last object an estimator.</p>
<p>注释：参数steps是一个list,list里面是一个个（name,transform）格式的tuple。最后一个tuple是估计函数（就是我们训练的模型类型）。而前面的tuple就是交叉验证的步骤。</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Multi-class-Classification">Multi-class Classification<a class="anchor-link" href="#Multi-class-Classification">¶</a></h3><p>The goal of multi-class classifcation is to assign an instance to one of the set of classes. scikit-learn uses a strategy called <strong>one-vs-all</strong>, or <strong>one-vs-the-rest</strong>, to support. One-vs-all uses one binary classifier for each of the possible classes. The class that is predicted with the greatest confidence is assigned to the instance. (LogisticRegression is using <em>one-vs-all</em> strategy to support multi-class classfification.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [7]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'data/train.tsv'</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">'</span><span class="se">\t</span><span class="s1">'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>PhraseId      156060
SentenceId    156060
Phrase        156060
Sentiment     156060
dtype: int64
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [8]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">'Sentiment'</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>count    156060.000000
mean          2.063578
std           0.893832
min           0.000000
25%           2.000000
50%           2.000000
75%           3.000000
max           4.000000
Name: Sentiment, dtype: float64
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [9]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">'Sentiment'</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>2    79582
3    32927
1    27273
4     9206
0     7072
Name: Sentiment, dtype: int64
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [10]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">'Sentiment'</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">/</span><span class="n">df</span><span class="p">[</span><span class="s1">'Sentiment'</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>2    0.509945
3    0.210989
1    0.174760
4    0.058990
0    0.045316
Name: Sentiment, dtype: float64
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Data Analysis from above data</strong>: The most common class, <em>Neutral</em>, includes more than 50% of instances. Hence <em>Accuracy</em> will not be an informative performance measure for this problem, as a degenerate classifer that predicts only <em>Neutral</em> can obtain an accuracy near 0.5.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [22]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="k">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="k">import</span> <span class="n">TfidfVectorizer</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model.logistic</span> <span class="k">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.cross_validation</span> <span class="k">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics.metrics</span> <span class="k">import</span> <span class="n">classification_report</span><span class="p">,</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">precision_score</span><span class="p">,</span> <span class="n">recall_score</span><span class="p">,</span> <span class="n">confusion_matrix</span>
<span class="kn">from</span> <span class="nn">sklearn.grid_search</span> <span class="k">import</span> <span class="n">GridSearchCV</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
            <span class="p">(</span><span class="s1">'vect'</span><span class="p">,</span> <span class="n">TfidfVectorizer</span><span class="p">(</span><span class="n">stop_words</span><span class="o">=</span><span class="s1">'english'</span><span class="p">)),</span>
            <span class="p">(</span><span class="s1">'clf'</span><span class="p">,</span> <span class="n">LogisticRegression</span><span class="p">())</span>         
        <span class="p">])</span>
    <span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">'vect__max_df'</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.25</span><span class="p">,</span><span class="mf">0.5</span><span class="p">),</span>
        <span class="s1">'vect__ngram_range'</span><span class="p">:</span> <span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span>
        <span class="s1">'vect__use_idf'</span><span class="p">:</span> <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
        <span class="s1">'clf__C'</span><span class="p">:(</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span>
    <span class="p">}</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'data/train.tsv'</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">'</span><span class="se">\t</span><span class="s1">'</span><span class="p">)</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">'Phrase'</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">'Sentiment'</span><span class="p">]</span><span class="o">.</span><span class="n">as_matrix</span><span class="p">()</span>
    <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">train_size</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">grid_search</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">pipeline</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">'accuracy'</span><span class="p">)</span>
    <span class="n">grid_search</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'Best score: </span><span class="si">%0.3f</span><span class="s1">'</span> <span class="o">%</span> <span class="n">grid_search</span><span class="o">.</span><span class="n">best_score_</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'Best parameters set:'</span><span class="p">)</span>
    <span class="n">best_parameters</span> <span class="o">=</span> <span class="n">grid_search</span><span class="o">.</span><span class="n">best_estimator_</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">param_name</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">parameters</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'</span><span class="se">\t</span><span class="si">%s</span><span class="s1">: </span><span class="si">%r</span><span class="s1">'</span> <span class="o">%</span> <span class="p">(</span><span class="n">param_name</span><span class="p">,</span> <span class="n">best_parameters</span><span class="p">[</span><span class="n">param_name</span><span class="p">]))</span>
    <span class="n">predictions</span> <span class="o">=</span> <span class="n">grid_search</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'Accuracy:'</span><span class="p">,</span>  <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predictions</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'Precision:'</span><span class="p">,</span> <span class="n">precision_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predictions</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'Recall:'</span><span class="p">,</span> <span class="n">recall_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predictions</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'Confusion_matrix:'</span><span class="p">,</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predictions</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'Classification report:'</span><span class="p">,</span> <span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predictions</span><span class="p">))</span>
    
    
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">'__main__'</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Fitting 3 folds for each of 24 candidates, totalling 72 fits
</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>[Parallel(n_jobs=3)]: Done  44 tasks      | elapsed:  1.8min
[Parallel(n_jobs=3)]: Done  72 out of  72 | elapsed:  3.9min finished
</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Best score: 0.618
Best parameters set:
	clf__C: 10
	vect__max_df: 0.25
	vect__ngram_range: (1, 2)
	vect__use_idf: False
('Accuracy:', 0.63776752531077796)
('Precision:', 0.62328304298382187)
('Recall:', 0.63776752531077796)
('Confusion_matrix:', array([[ 1168,  1664,   654,    56,     9],
       [  905,  6039,  6202,   500,    21],
       [  197,  3120, 32691,  3589,   154],
       [   21,   412,  6538,  8213,  1220],
       [    4,    40,   536,  2423,  1654]]))
('Classification report:', '             precision    recall  f1-score   support\n\n          0       0.51      0.33      0.40      3551\n          1       0.54      0.44      0.48     13667\n          2       0.70      0.82      0.76     39751\n          3       0.56      0.50      0.53     16404\n          4       0.54      0.36      0.43      4657\n\navg / total       0.62      0.64      0.62     78030\n')
</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>C:\Anaconda\lib\site-packages\sklearn\metrics\classification.py:1203: DeprecationWarning: The default `weighted` averaging is deprecated, and from version 0.18, use of precision, recall or F-score with multiclass or multilabel data or pos_label=None will result in an exception. Please set an explicit value for `average`, one of (None, 'micro', 'macro', 'weighted', 'samples'). In cross validation use, for instance, scoring="f1_weighted" instead of scoring="f1".
  sample_weight=sample_weight)
C:\Anaconda\lib\site-packages\sklearn\metrics\classification.py:1304: DeprecationWarning: The default `weighted` averaging is deprecated, and from version 0.18, use of precision, recall or F-score with multiclass or multilabel data or pos_label=None will result in an exception. Please set an explicit value for `average`, one of (None, 'micro', 'macro', 'weighted', 'samples'). In cross validation use, for instance, scoring="f1_weighted" instead of scoring="f1".
  sample_weight=sample_weight)
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Multi-Label-Classfiication-and-Transformation">Multi-Label Classfiication and Transformation<a class="anchor-link" href="#Multi-Label-Classfiication-and-Transformation">¶</a></h3>
</div>
</div>
</div>

<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        " linebreaks: { automatic: true, width: '95% container' }, " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>

  </div>
  

</article>
        </div><!-- /content -->

    </div><!--/.container /#main-container -->

    <footer id="site-footer">
 
      <address id="site-colophon">
        <p class="text-center text-muted">
        Site built using <a href="http://getpelican.com/" target="_blank">Pelican</a>
        &nbsp;&bull;&nbsp; Theme based on
        <a href="http://www.voidynullness.net/page/voidy-bootstrap-pelican-theme/"
           target="_blank">VoidyBootstrap</a> by 
        <a href="http://www.robertiwancz.com/"
           target="_blank">RKI</a>  
        </p>
      </address><!-- /colophon  -->
    </footer>


    <!-- javascript -->
   
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js" integrity="sha384-nvAa0+6Qg9clwYCGGPpDQLVpLNn0fRaROjHqs13t4Ggj3Ez50XnGQqc/r8MhnRDZ" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"
            integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"
            crossorigin="anonymous"></script>


  </body>
</html>